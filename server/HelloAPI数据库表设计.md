# 数据库设计

### 接口主表 (`api_apps`)

存储接口的基础定义、请求地址及返回信息

| **字段名**      | **类型**     | **必填** | **备注**                  |
| --------------- | ------------ | -------- | ------------------------- |
| `id`            | int(10)      | 是       | 唯一ID (自增主键)         |
| `title`         | varchar(255) | 是       | 接口名                    |
| `smallTitle`    | varchar(255) | 是       | 接口描述                  |
| `status`        | int(2)       | 是       | 状态：正常0，异常1，维护2 |
| `type`          | int(2)       | 是       | 接口类型：免费0，付费1    |
| `url`           | varchar(255) | 是       | 请求地址                  |
| `sendType`      | int(2)       | 是       | 请求类型：0 GET、1 POST   |
| `returnType`    | varchar(255) | 是       | 返回类型                  |
| `returnContent` | longtext     | 是       | 返回内容                  |
| `created`       | bigint(13)   | 是       | 创建时间 (时间戳)         |
| `user_id`       | int(10)      | 是       | 这个接口的用户ID          |

### 接口密钥表 (`api_keys`)

管理具体接口的访问授权、计费模式和有效期

| **字段名** | **类型**     | **必填** | **备注**               |
| ---------- | ------------ | -------- | ---------------------- |
| `api_id`   | int(10)      | 是       | 对应的API的ID          |
| `key`      | varchar(255) | 是       | api密钥 (主键)         |
| `created`  | bigint(13)   | 是       | 创建时间               |
| `type`     | int(2)       | 是       | 计费类型：0时间，1次数 |
| `started`  | bigint(13)   | 是       | 开始时间               |
| `expired`  | bigint(13)   | 是       | 过期时间               |
| `count`    | bigint(13)   | 是       | 可用次数               |

### 接口参数表 (`api_params`)

定义接口请求时所需的参数及其要求

| **字段名** | **类型**     | **必填** | **备注**           |
| ---------- | ------------ | -------- | ------------------ |
| `api_id`   | int(10)      | 是       | 对应的Api唯一ID    |
| `name`     | varchar(255) | 是       | 参数名             |
| `required` | int(2)       | 是       | 是否必填：0否，1是 |
| `type`     | varchar(255) | 是       | 参数类型           |
| `msg`      | varchar(255) | 是       | 参数描述           |

### 接口请求日志表 (`api_request_logs`)

记录接口调用的详细日志

| **字段名** | **类型**     | **必填** | **备注**                |
| ---------- | ------------ | -------- | ----------------------- |
| `api_id`   | int(10)      | 是       | 对应的API的ID           |
| `ip`       | varchar(255) | 否       | 请求IP                  |
| `time`     | datetime     | 否       | 日期时间 (默认当前时间) |
| `header`   | json         | 否       | 请求头信息              |
| `body`     | json         | 否       | 请求参数内容            |

### 接口统计表 (`api_views`)

记录接口累计被调用的总次数

| **字段名** | **类型**   | **必填** | **备注**      |
| ---------- | ---------- | -------- | ------------- |
| `api_id`   | int(10)    | 是       | 接口ID (主键) |
| `count`    | bigint(13) | 是       | 访问计数      |

### 用户密钥表 (`user_keys`)

关联用户与其全局访问密钥

| **字段名** | **类型**     | **必填** | **备注**            |
| ---------- | ------------ | -------- | ------------------- |
| `user_id`  | int(10)      | 是       | 对应的用户ID (主键) |
| `key`      | varchar(255) | 是       | 用户接口Key         |
| `created`  | bigint(13)   | 是       | 创建时间            |

### 用户表 (`users`)

存储系统用户信息及权限等级

| **字段名** | **类型**     | **必填** | **备注**                 |
| ---------- | ------------ | -------- | ------------------------ |
| `id`       | int(10)      | 是       | 用户唯一ID (自增主键)    |
| `name`     | varchar(255) | 是       | 用户名                   |
| `password` | varchar(255) | 是       | 密码                     |
| `nick`     | varchar(255) | 是       | 用户昵称                 |
| `mode`     | int(2)       | 是       | 用户类型：0普通，1管理员 |
| `mail`     | varchar(255) | 否       | 邮箱                     |
